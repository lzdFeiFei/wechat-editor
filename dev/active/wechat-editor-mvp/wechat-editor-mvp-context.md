# å¾®ä¿¡å…¬ä¼—å·æ’ç‰ˆå·¥å…· MVP - ä¸Šä¸‹æ–‡æ–‡æ¡£

**æœ€åæ›´æ–°ï¼š2025-12-30 18:30**

---

## SESSION PROGRESS (2025-12-30 æœ€æ–°)

### âœ… å·²å®Œæˆé˜¶æ®µ
- âœ… **é˜¶æ®µ1ï¼šé¡¹ç›®åŸºç¡€è®¾æ–½** (100%)
  - Vite + React 18 + TypeScript é¡¹ç›®åˆå§‹åŒ–
  - Tailwind CSS 4 é…ç½®å®Œæˆ
  - ESLint + Prettier ä»£ç è§„èŒƒ
  - è·¯å¾„åˆ«åé…ç½®ï¼ˆ@/ï¼‰
  - Gitæäº¤ï¼š`4acdc5b - chore(init): å®Œæˆé˜¶æ®µ1é¡¹ç›®åŸºç¡€è®¾æ–½æ­å»º`

- âœ… **é˜¶æ®µ2ï¼šå¯Œæ–‡æœ¬ç¼–è¾‘å™¨é›†æˆ** (100%)
  - Quill.js ç¼–è¾‘å™¨é›†æˆå’Œé…ç½®
  - ä¸‰æ å“åº”å¼å¸ƒå±€ï¼ˆHeader, StylePanel, Editor, Preview, Toolbarï¼‰
  - å¿«æ·é”®æ”¯æŒï¼ˆCtrl+B/I/U/Z/Y/S/Kï¼‰
  - è‡ªåŠ¨ä¿å­˜æœºåˆ¶ï¼ˆæ¯30ç§’ï¼‰
  - æ’¤é”€/é‡åšå†å²è®°å½•ï¼ˆæœ€å¤š100æ­¥ï¼‰
  - ç²˜è´´æ–‡æœ¬è‡ªåŠ¨æ¸…é™¤æ ¼å¼
  - å­—æ•°ç»Ÿè®¡å’Œé˜…è¯»æ—¶é—´ä¼°ç®—
  - Gitæäº¤ï¼š
    - `a282aed - feat(editor): å®ŒæˆåŸºç¡€å¸ƒå±€å’ŒQuillç¼–è¾‘å™¨é›†æˆ`
    - `72daf68 - feat(editor): å®Œæˆç¼–è¾‘å™¨åŠŸèƒ½å¢å¼º`

- âœ… **é˜¶æ®µ3ï¼šæ ·å¼å·¥å…·æ ** (100%)
  - å®Œæ•´çš„æ–‡å­—æ ·å¼å·¥å…·ï¼ˆH1/H2/H3ã€ç²—ä½“/æ–œä½“/ä¸‹åˆ’çº¿/åˆ é™¤çº¿ï¼‰
  - é¢œè‰²é€‰æ‹©å™¨ï¼ˆ8ç§æ–‡å­—è‰²ã€7ç§èƒŒæ™¯è‰²ï¼‰
  - æ®µè½å¯¹é½å’Œåˆ—è¡¨åŠŸèƒ½
  - ç‰¹æ®Šç»„ä»¶ï¼ˆå¼•ç”¨æ¡†ã€è‡ªå®šä¹‰åˆ†å‰²çº¿Blotï¼‰
  - 5å¥—ä¸»é¢˜é…è‰²æ–¹æ¡ˆï¼ˆç»å…¸é»‘ç™½ã€ç§‘æŠ€è“ã€æ¸…æ–°ç»¿ã€æ¸©æš–æ©™ã€ä¼˜é›…ç´«ï¼‰
  - ä¸»é¢˜å®æ—¶é¢„è§ˆå’Œæœ¬åœ°æŒä¹…åŒ–
  - Gitæäº¤ï¼š
    - `7e37885 - feat(style): å®ç°æ ·å¼å·¥å…·æ æ ¸å¿ƒåŠŸèƒ½`
    - `c88bf9b - feat(theme): å®Œæˆé¢œè‰²ä¸»é¢˜ç³»ç»Ÿ`

- âœ… **é˜¶æ®µ4ï¼šå®æ—¶é¢„è§ˆç³»ç»Ÿ** (100%)
  - æ‰‹æœºè§†å›¾é¢„è§ˆç»„ä»¶ï¼ˆ375pxå®½åº¦ï¼‰
  - ä¸»é¢˜æ ·å¼åŠ¨æ€æ³¨å…¥
  - å®æ—¶åŒæ­¥ç¼–è¾‘å†…å®¹
  - HTMLæ¸²æŸ“é¢„è§ˆ

- âœ… **é˜¶æ®µ8ï¼šä¸€é”®å¤åˆ¶åŠŸèƒ½** (100%)
  - HTMLç”Ÿæˆå’Œæ¸…ç†å¼•æ“
  - æ ·å¼è½¬å†…è”ï¼ˆç¬¦åˆå¾®ä¿¡è§„èŒƒï¼‰
  - 27ä¸ªå…è®¸çš„CSSå±æ€§ç™½åå•è¿‡æ»¤
  - å¤åˆ¶åˆ°å‰ªè´´æ¿ï¼ˆæ”¯æŒHTMLæ ¼å¼ï¼‰
  - ç°ä»£Clipboard API + execCommandé™çº§æ–¹æ¡ˆ
  - å¤åˆ¶çŠ¶æ€æç¤ºå’Œä½¿ç”¨æŒ‡å¼•
  - æ¸…ç©ºå†…å®¹åŠŸèƒ½
  - Gitæäº¤ï¼š`f1b65b0 - feat(copy): å®ç°ä¸€é”®å¤åˆ¶åˆ°å¾®ä¿¡å…¬ä¼—å·åŠŸèƒ½`

- âœ… **é˜¶æ®µ5ï¼šæ¨¡æ¿ç³»ç»Ÿ** (100%) - **æœ¬æ¬¡ä¼šè¯å®Œæˆ**
  - 5å¥—é¢„è®¾æ¨¡æ¿ï¼ˆç®€çº¦/å•†åŠ¡/æ–‡è‰º/ç§‘æŠ€/æ´»æ³¼ï¼‰
  - æ¨¡æ¿é€‰æ‹©å’Œé¢„è§ˆç•Œé¢ï¼ˆTemplateModalï¼‰
  - ä¸€é”®åº”ç”¨æ¨¡æ¿ï¼ˆå†…å®¹+ä¸»é¢˜ï¼‰
  - è‡ªå®šä¹‰æ¨¡æ¿ä¿å­˜ç³»ç»Ÿï¼ˆSaveTemplateModalï¼Œæœ€å¤š10ä¸ªï¼‰
  - è‡ªå®šä¹‰æ¨¡æ¿ç®¡ç†ï¼ˆåˆ é™¤åŠŸèƒ½ï¼‰
  - æ¨¡æ¿æœ¬åœ°æŒä¹…åŒ–å­˜å‚¨ï¼ˆlocalStorageï¼‰
  - Gitæäº¤ï¼š`2bd6844 - feat(template): å®ç°æ¨¡æ¿ç³»ç»ŸåŠŸèƒ½`

### ğŸŸ¡ è¿›è¡Œä¸­
- æ— ï¼ˆå½“å‰æ‰€æœ‰å¼€å‘ä»»åŠ¡å·²å®Œæˆï¼‰

### â³ å¾…å¼€å§‹
- **é˜¶æ®µ6ï¼šå›¾ç‰‡å¤„ç†**
  - å›¾ç‰‡ä¸Šä¼ ï¼ˆæœ¬åœ°æ–‡ä»¶ã€æ‹–æ‹½ä¸Šä¼ ï¼‰
  - å›¾ç‰‡å‹ç¼©ï¼ˆä½¿ç”¨Canvas APIï¼Œæœ€å¤§å®½åº¦900pxï¼‰
  - å›¾ç‰‡æ ·å¼è°ƒæ•´ï¼ˆå®½åº¦ã€è¾¹æ¡†ã€è¯´æ˜æ–‡å­—ï¼‰

- **é˜¶æ®µ7ï¼šè‰ç¨¿ç³»ç»Ÿ**
  - è‰ç¨¿åˆ—è¡¨ç®¡ç†ç•Œé¢
  - è‰ç¨¿é‡å‘½å/åˆ é™¤åŠŸèƒ½
  - å¤šè‰ç¨¿å­˜å‚¨ï¼ˆæœ€å¤š10ç¯‡ï¼‰
  - è‰ç¨¿æœç´¢åŠŸèƒ½

- **é˜¶æ®µ9ï¼šç”¨æˆ·ä½“éªŒä¼˜åŒ–**
  - é¦–æ¬¡ä½¿ç”¨å¼•å¯¼
  - å¸®åŠ©æç¤ºå’Œæ–‡æ¡£
  - é”™è¯¯å¤„ç†ä¼˜åŒ–
  - æ€§èƒ½ä¼˜åŒ–ï¼ˆä»£ç åˆ†å‰²ã€æ‡’åŠ è½½ï¼‰

- **é˜¶æ®µ10ï¼šæµ‹è¯•å’Œå‘å¸ƒ**
  - åŠŸèƒ½æµ‹è¯•
  - æµè§ˆå™¨å…¼å®¹æ€§æµ‹è¯•
  - å¾®ä¿¡å…¬ä¼—å·å…¼å®¹æ€§æµ‹è¯•
  - ç”Ÿäº§æ„å»ºé…ç½®
  - Vercel/Netlifyéƒ¨ç½²

### âš ï¸ é˜»å¡ç‚¹å’Œå·²è§£å†³é—®é¢˜
- âœ… **å·²è§£å†³ï¼šTailwind CSS 4 PostCSSé…ç½®é—®é¢˜**
  - é—®é¢˜ï¼šTailwind v4éœ€è¦ä½¿ç”¨`@tailwindcss/postcss`æ’ä»¶
  - è§£å†³ï¼šå®‰è£…`@tailwindcss/postcss`å¹¶æ›´æ–°`postcss.config.js`

- âœ… **å·²è§£å†³ï¼šTypeScriptç¼–è¯‘é”™è¯¯**
  - é—®é¢˜1ï¼šEditor.tsxä¸­Quill Deltaç±»å‹æ¨æ–­é”™è¯¯
  - è§£å†³ï¼šä½¿ç”¨ç±»å‹æ–­è¨€`as any`å’Œæ˜ç¡®çš„ç±»å‹è½¬æ¢
  - é—®é¢˜2ï¼šuseAutoSave.tsä¸­`NodeJS.Timeout`ç±»å‹é—®é¢˜
  - è§£å†³ï¼šæ”¹ç”¨æµè§ˆå™¨åŸç”Ÿ`number`ç±»å‹ï¼ˆ`setTimeout`è¿”å›å€¼ï¼‰
  - é—®é¢˜3ï¼šquill-divider.ts Blotæ³¨å†Œé—®é¢˜
  - è§£å†³ï¼šæ·»åŠ `scope`å±æ€§å’Œæ­£ç¡®çš„æ³¨å†Œæ ¼å¼

---

## é¡¹ç›®å½“å‰çŠ¶æ€

### å®Œæˆåº¦
**æ€»ä½“è¿›åº¦ï¼š60%** (6/10ä¸ªé˜¶æ®µå®Œæˆ)

### æŠ€æœ¯æ ˆï¼ˆå·²å®ç°ï¼‰
- **å‰ç«¯æ¡†æ¶**ï¼šReact 18.3.1 + TypeScript 5.6.2
- **æ„å»ºå·¥å…·**ï¼šVite 5.4.21
- **æ ·å¼æ–¹æ¡ˆ**ï¼šTailwind CSS 4.1.18 + @tailwindcss/postcss
- **å¯Œæ–‡æœ¬ç¼–è¾‘å™¨**ï¼šQuill 2.0.3
- **å›¾æ ‡åº“**ï¼šLucide React 0.468.0
- **çŠ¶æ€ç®¡ç†**ï¼šReact Context + Hooks + localStorage
- **ä»£ç è§„èŒƒ**ï¼šESLint 9.17.0 + Prettier 3.4.2

### é¡¹ç›®å®é™…ç»“æ„
```
wechat-editor/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ components/             # Reactç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ Header.tsx          # é¡¶éƒ¨å¯¼èˆªæ ï¼ˆå¸¦æ¨¡æ¿æŒ‰é’®ï¼‰
â”‚   â”‚   â”œâ”€â”€ StylePanel.tsx      # æ ·å¼å·¥å…·æ ï¼ˆå®Œæ•´æ ·å¼+ä¸»é¢˜é€‰æ‹©ï¼‰
â”‚   â”‚   â”œâ”€â”€ Editor.tsx          # Quillç¼–è¾‘å™¨ï¼ˆå¿«æ·é”®+è‡ªåŠ¨ä¿å­˜ï¼‰
â”‚   â”‚   â”œâ”€â”€ Preview.tsx         # é¢„è§ˆåŒºï¼ˆæ‰‹æœºè§†å›¾+ä¸»é¢˜åº”ç”¨ï¼‰
â”‚   â”‚   â”œâ”€â”€ Toolbar.tsx         # åº•éƒ¨å·¥å…·æ ï¼ˆå¤åˆ¶+æ¸…ç©ºï¼‰
â”‚   â”‚   â”œâ”€â”€ TemplateModal.tsx   # æ¨¡æ¿é€‰æ‹©å¼¹çª—
â”‚   â”‚   â””â”€â”€ SaveTemplateModal.tsx # ä¿å­˜æ¨¡æ¿å¼¹çª—
â”‚   â”œâ”€â”€ contexts/
â”‚   â”‚   â””â”€â”€ EditorContext.tsx   # å…¨å±€çŠ¶æ€ï¼ˆcontent, quillå®ä¾‹, themeï¼‰
â”‚   â”œâ”€â”€ hooks/                  # è‡ªå®šä¹‰Hooks
â”‚   â”‚   â”œâ”€â”€ useEditor.ts        # å†…å®¹ç®¡ç†ï¼ˆå­—æ•°ã€é˜…è¯»æ—¶é—´ï¼‰
â”‚   â”‚   â”œâ”€â”€ useKeyboardShortcuts.ts # å¿«æ·é”®
â”‚   â”‚   â”œâ”€â”€ useAutoSave.ts      # è‡ªåŠ¨ä¿å­˜
â”‚   â”‚   â”œâ”€â”€ useTheme.ts         # ä¸»é¢˜ç®¡ç†
â”‚   â”‚   â”œâ”€â”€ useCopyToClipboard.ts # å¤åˆ¶åŠŸèƒ½
â”‚   â”‚   â”œâ”€â”€ useEditorCommands.ts # ç¼–è¾‘å™¨å‘½ä»¤
â”‚   â”‚   â””â”€â”€ useTemplates.ts     # æ¨¡æ¿ç®¡ç†
â”‚   â”œâ”€â”€ utils/                  # å·¥å…·å‡½æ•°
â”‚   â”‚   â”œâ”€â”€ storage.ts          # localStorageæ“ä½œ
â”‚   â”‚   â”œâ”€â”€ wechat-html.ts      # å¾®ä¿¡HTMLè½¬æ¢å¼•æ“
â”‚   â”‚   â”œâ”€â”€ theme-styles.ts     # ä¸»é¢˜CSSç”Ÿæˆ
â”‚   â”‚   â””â”€â”€ quill-divider.ts    # è‡ªå®šä¹‰åˆ†å‰²çº¿Blot
â”‚   â”œâ”€â”€ types/                  # TypeScriptç±»å‹
â”‚   â”‚   â”œâ”€â”€ index.ts            # åŸºç¡€ç±»å‹
â”‚   â”‚   â”œâ”€â”€ style.ts            # æ ·å¼å¸¸é‡
â”‚   â”‚   â”œâ”€â”€ theme.ts            # ä¸»é¢˜ç±»å‹
â”‚   â”‚   â””â”€â”€ template.ts         # æ¨¡æ¿ç±»å‹
â”‚   â”œâ”€â”€ styles/
â”‚   â”‚   â””â”€â”€ quill-custom.css    # Quillè‡ªå®šä¹‰æ ·å¼
â”‚   â”œâ”€â”€ App.tsx                 # ä¸»åº”ç”¨ç»„ä»¶
â”‚   â”œâ”€â”€ main.tsx                # å…¥å£æ–‡ä»¶
â”‚   â””â”€â”€ index.css               # å…¨å±€æ ·å¼ï¼ˆTailwindå¯¼å…¥ï¼‰
â”œâ”€â”€ public/                     # é™æ€èµ„æº
â”œâ”€â”€ dev/                        # å¼€å‘æ–‡æ¡£
â”‚   â””â”€â”€ active/wechat-editor-mvp/
â”œâ”€â”€ .claude/                    # Claude Codeé…ç½®
â”œâ”€â”€ dist/                       # æ„å»ºè¾“å‡º
â”œâ”€â”€ package.json
â”œâ”€â”€ tsconfig.json
â”œâ”€â”€ vite.config.ts
â”œâ”€â”€ tailwind.config.js
â”œâ”€â”€ postcss.config.js
â””â”€â”€ .eslintrc.cjs
```

---

## æ ¸å¿ƒæŠ€æœ¯å®ç°ç»†èŠ‚

### 1. å¾®ä¿¡HTMLè½¬æ¢å¼•æ“ (wechat-html.ts)

**å…³é”®åŠŸèƒ½**ï¼šå°†ç¼–è¾‘å™¨HTMLè½¬æ¢ä¸ºå¾®ä¿¡å…¬ä¼—å·å…¼å®¹çš„æ ¼å¼

**å®ç°åŸç†**ï¼š
```typescript
// 1. å…è®¸çš„CSSå±æ€§ç™½åå•ï¼ˆ27ä¸ªï¼‰
const ALLOWED_CSS_PROPERTIES = [
  'color', 'font-size', 'font-weight', 'font-style',
  'text-decoration', 'text-align', 'line-height',
  'background-color', 'padding', 'margin', 'border',
  'border-radius', 'width', 'height', 'max-width', 'display'
  // ... ç­‰
]

// 2. é€’å½’å¤„ç†DOMå…ƒç´ 
function processElement(element: HTMLElement, theme: Theme) {
  // a. åº”ç”¨ä¸»é¢˜æ ·å¼ï¼ˆh1/h2/h3/p/blockquote/hrï¼‰
  applyThemeStyles(element, theme)

  // b. è½¬æ¢classä¸ºå†…è”æ ·å¼
  convertClassToInlineStyle(element) // ä½¿ç”¨getComputedStyle

  // c. æ¸…ç†ä¸æ”¯æŒçš„å±æ€§ï¼ˆdata-*, contenteditableï¼‰
  cleanUnsupportedAttributes(element)

  // d. å¤„ç†ç‰¹æ®Šæ ‡ç­¾ï¼ˆè®¾ç½®å›ºå®šæ ·å¼ï¼‰
  processSpecialTags(element, theme)

  // e. é€’å½’å¤„ç†å­å…ƒç´ 
  if (element.children.length > 0) {
    processElement(element, theme)
  }
}

// 3. æ¸…ç†ç©ºæ ‡ç­¾
function cleanEmptyTags(html: string): string {
  // ç§»é™¤ç©ºçš„<p>æ ‡ç­¾å’ŒåªåŒ…å«<br>çš„<p>æ ‡ç­¾
}
```

**å…³é”®å†³ç­–**ï¼š
- ä½¿ç”¨`getComputedStyle`è·å–è®¡ç®—åçš„æ ·å¼ï¼Œç¡®ä¿æ‰€æœ‰CSSéƒ½è½¬ä¸ºå†…è”
- ç§»é™¤æ‰€æœ‰classå±æ€§ï¼Œé¿å…å¾®ä¿¡è¿‡æ»¤
- ä¸ºç‰¹æ®Šæ ‡ç­¾ï¼ˆh1/h2/h3/blockquoteç­‰ï¼‰è®¾ç½®å›ºå®šæ ·å¼ï¼Œç¡®ä¿ä¸€è‡´æ€§

### 2. ä¸»é¢˜ç³»ç»Ÿ (theme.ts + theme-styles.ts)

**5å¥—é¢„è®¾ä¸»é¢˜**ï¼š
```typescript
interface Theme {
  id: string
  name: string
  description: string
  colors: {
    primary: string          // ä¸»è‰²è°ƒ
    headingColor: string     // æ ‡é¢˜é¢œè‰²
    textColor: string        // æ­£æ–‡é¢œè‰²
    linkColor: string        // é“¾æ¥é¢œè‰²
    quoteBackground: string  // å¼•ç”¨æ¡†èƒŒæ™¯
    quoteBorder: string      // å¼•ç”¨æ¡†å·¦è¾¹æ¡†
    dividerColor: string     // åˆ†å‰²çº¿é¢œè‰²
  }
}

// é¢„è®¾ä¸»é¢˜
1. classicï¼ˆç»å…¸é»‘ç™½ï¼‰
2. tech-blueï¼ˆç§‘æŠ€è“ï¼‰
3. fresh-greenï¼ˆæ¸…æ–°ç»¿ï¼‰
4. warm-orangeï¼ˆæ¸©æš–æ©™ï¼‰
5. elegant-purpleï¼ˆä¼˜é›…ç´«ï¼‰
```

**åŠ¨æ€CSSæ³¨å…¥**ï¼š
```typescript
// Previewç»„ä»¶ä¸­ä½¿ç”¨
const themeStyles = useMemo(() => generateThemeStyles(currentTheme), [currentTheme])

return (
  <div className="preview-container">
    <style>{themeStyles}</style>
    <div dangerouslySetInnerHTML={{ __html: content.html }} />
  </div>
)
```

### 3. æ¨¡æ¿ç³»ç»Ÿ (template.ts + useTemplates.ts)

**æ¨¡æ¿æ•°æ®ç»“æ„**ï¼š
```typescript
interface Template {
  id: string
  name: string
  description: string
  category: 'preset' | 'custom'
  theme: Theme              // å…³è”ä¸»é¢˜
  content: string           // HTMLå†…å®¹
  preview: string           // é¢„è§ˆæ ‡è¯†
  createdAt?: number        // åˆ›å»ºæ—¶é—´ï¼ˆè‡ªå®šä¹‰æ¨¡æ¿ï¼‰
}
```

**5å¥—é¢„è®¾æ¨¡æ¿å†…å®¹ç‰¹ç‚¹**ï¼š
1. **ç®€çº¦é£æ ¼**ï¼šåŸºç¡€ç»“æ„ï¼Œé€‚åˆæ—¥å¸¸æ–‡ç« 
2. **å•†åŠ¡é£æ ¼**ï¼šå¸¦ç›®å½•å’Œåˆ†èŠ‚ï¼Œé€‚åˆä¼ä¸šå®£ä¼ 
3. **æ–‡è‰ºé£æ ¼**ï¼šå¸¦æ—¥æœŸå’Œå¼•è¨€ï¼Œé€‚åˆæ•£æ–‡éšç¬”
4. **ç§‘æŠ€é£æ ¼**ï¼šå¸¦emojiå›¾æ ‡å’Œç»“æ„åŒ–å†…å®¹ï¼Œé€‚åˆæŠ€æœ¯æ–‡ç« 
5. **æ´»æ³¼é£æ ¼**ï¼šè½»æ¾è¯­æ°”ï¼Œå¸¦é—®å€™è¯­ï¼Œé€‚åˆç”Ÿæ´»åˆ†äº«

**æ¨¡æ¿ç®¡ç†é€»è¾‘**ï¼š
```typescript
// localStorageå­˜å‚¨
const CUSTOM_TEMPLATES_KEY = 'wechat_editor_custom_templates'
const MAX_CUSTOM_TEMPLATES = 10

// åŠ è½½ã€ä¿å­˜ã€åˆ é™¤è‡ªå®šä¹‰æ¨¡æ¿
useEffect(() => {
  const stored = localStorage.getItem(CUSTOM_TEMPLATES_KEY)
  if (stored) {
    const templates = JSON.parse(stored)
    setCustomTemplates(templates)
    setAllTemplates([...PRESET_TEMPLATES, ...templates])
  }
}, [])
```

### 4. è‡ªå®šä¹‰Quill Blot (quill-divider.ts)

**åˆ†å‰²çº¿Blotå®ç°**ï¼š
```typescript
const BlockEmbed = Quill.import('blots/block/embed') as any

class DividerBlot extends BlockEmbed {
  static blotName = 'divider'
  static tagName = 'hr'
  static className = 'ql-divider'
  static scope = Quill.import('parchment').Scope.BLOCK_BLOT

  static create() {
    const node = super.create() as HTMLElement
    node.setAttribute('contenteditable', 'false')
    node.style.border = 'none'
    node.style.borderTop = '2px solid #e5e7eb'
    node.style.margin = '20px 0'
    return node
  }
}

// æ³¨å†Œæ–¹å¼
Quill.register({ 'formats/divider': DividerBlot }, true)
```

**å…³é”®ç‚¹**ï¼š
- å¿…é¡»æ·»åŠ `scope`å±æ€§æ‰èƒ½æ­£ç¡®æ³¨å†Œ
- ä½¿ç”¨`as any`ç»•è¿‡TypeScriptç±»å‹æ£€æŸ¥
- æ³¨å†Œæ—¶ä½¿ç”¨`{ 'formats/divider': DividerBlot }`æ ¼å¼

### 5. å¤åˆ¶åŠŸèƒ½ (useCopyToClipboard.ts)

**åŒå±‚é™çº§æ–¹æ¡ˆ**ï¼š
```typescript
async function copyHTML(html: string) {
  try {
    // æ–¹æ¡ˆ1ï¼šç°ä»£Clipboard APIï¼ˆæ”¯æŒHTMLæ ¼å¼ï¼‰
    if (navigator.clipboard && window.ClipboardItem) {
      const htmlBlob = new Blob([html], { type: 'text/html' })
      const textBlob = new Blob([html], { type: 'text/plain' })
      const clipboardItem = new ClipboardItem({
        'text/html': htmlBlob,
        'text/plain': textBlob,
      })
      await navigator.clipboard.write([clipboardItem])
    } else {
      // æ–¹æ¡ˆ2ï¼šdocument.execCommandé™çº§
      const textarea = document.createElement('textarea')
      textarea.value = html
      textarea.style.position = 'fixed'
      textarea.style.opacity = '0'
      document.body.appendChild(textarea)
      textarea.select()
      document.execCommand('copy')
      document.body.removeChild(textarea)
    }
  } catch (error) {
    console.error('Copy failed:', error)
  }
}
```

---

## å…³é”®æŠ€æœ¯æŒ‘æˆ˜å’Œè§£å†³æ–¹æ¡ˆ

### æŒ‘æˆ˜1ï¼šTailwind CSS 4 å‡çº§é—®é¢˜
**é—®é¢˜**ï¼šTailwind v4æ”¹å˜äº†PostCSSæ’ä»¶æ¶æ„ï¼Œç›´æ¥ä½¿ç”¨`tailwindcss`ä¼šæŠ¥é”™

**é”™è¯¯ä¿¡æ¯**ï¼š
```
It looks like you're trying to use `tailwindcss` directly as a PostCSS plugin.
The PostCSS plugin has moved to a separate package...
```

**è§£å†³æ–¹æ¡ˆ**ï¼š
```bash
npm install --save-dev @tailwindcss/postcss
```
```javascript
// postcss.config.js
export default {
  plugins: {
    '@tailwindcss/postcss': {},  // ä½¿ç”¨æ–°åŒ…
    autoprefixer: {},
  },
}
```

### æŒ‘æˆ˜2ï¼šQuill TypeScriptç±»å‹é—®é¢˜
**é—®é¢˜1**ï¼š`Quill.import('delta')`ç±»å‹æ¨æ–­å¤±è´¥

**è§£å†³æ–¹æ¡ˆ**ï¼š
```typescript
// ä½¿ç”¨ç±»å‹æ–­è¨€
const Delta = Quill.import('delta') as any
return new Delta().insert(plaintext)
```

**é—®é¢˜2**ï¼šBlotç»§æ‰¿ç±»å‹é”™è¯¯

**è§£å†³æ–¹æ¡ˆ**ï¼š
```typescript
// å¯¼å…¥æ—¶æ–­è¨€ä¸ºany
const BlockEmbed = Quill.import('blots/block/embed') as any
class DividerBlot extends BlockEmbed { ... }
```

### æŒ‘æˆ˜3ï¼šæµè§ˆå™¨ç¯å¢ƒsetTimeoutç±»å‹
**é—®é¢˜**ï¼šNode.jsçš„`NodeJS.Timeout`åœ¨æµè§ˆå™¨ç¯å¢ƒä¸å­˜åœ¨

**é”™è¯¯**ï¼š
```
error TS2503: Cannot find namespace 'NodeJS'.
```

**è§£å†³æ–¹æ¡ˆ**ï¼š
```typescript
// ä½¿ç”¨æµè§ˆå™¨åŸç”Ÿnumberç±»å‹
const timeoutRef = useRef<number>()  // ä¸æ˜¯NodeJS.Timeout
```

### æŒ‘æˆ˜4ï¼šThemeç±»å‹ä¸åŒ¹é…
**é—®é¢˜**ï¼šæ¨¡æ¿ä¸­çš„Themeå®šä¹‰ç¼ºå°‘`description`å­—æ®µï¼Œå¯¼è‡´ç±»å‹é”™è¯¯

**è§£å†³æ–¹æ¡ˆ**ï¼š
```typescript
// æ‰€æœ‰ä¸»é¢˜å¯¹è±¡å¿…é¡»åŒ…å«å®Œæ•´å­—æ®µ
theme: {
  id: 'classic',
  name: 'ç»å…¸é»‘ç™½',
  description: 'é»‘è‰²æ ‡é¢˜ï¼Œæ·±ç°æ­£æ–‡ï¼Œç»å…¸è€çœ‹',  // å¿…éœ€
  colors: { ... }
}
```

---

## localStorageæ•°æ®ç»“æ„

### å½“å‰è‰ç¨¿
**Key**: `wechat_editor_current_draft`
```typescript
{
  html: string,           // HTMLå†…å®¹
  savedAt: number         // ä¿å­˜æ—¶é—´æˆ³
}
```

### å½“å‰ä¸»é¢˜
**Key**: `wechat_editor_current_theme`
```typescript
{
  id: string,             // ä¸»é¢˜ID
  name: string,
  description: string,
  colors: { ... }
}
```

### è‡ªå®šä¹‰æ¨¡æ¿
**Key**: `wechat_editor_custom_templates`
```typescript
[
  {
    id: string,
    name: string,
    description: string,
    category: 'custom',
    theme: Theme,
    content: string,
    preview: 'custom',
    createdAt: number
  },
  // ... æœ€å¤š10ä¸ª
]
```

---

## å¿«é€Ÿæ¢å¤æŒ‡å—ï¼ˆé‡è¦ï¼ï¼‰

### å¦‚æœä¸Šä¸‹æ–‡é‡ç½®åç»§ç»­å¼€å‘

#### 1. ç«‹å³æ£€æŸ¥çš„å†…å®¹
```bash
# æ£€æŸ¥é¡¹ç›®çŠ¶æ€
npm run dev          # ç¡®è®¤é¡¹ç›®èƒ½æ­£å¸¸è¿è¡Œ
npm run build        # ç¡®è®¤æ„å»ºæ— é”™è¯¯
git status           # æŸ¥çœ‹æ˜¯å¦æœ‰æœªæäº¤çš„æ›´æ”¹
git log --oneline -10 # æŸ¥çœ‹æœ€è¿‘çš„æäº¤

# å½“å‰æœ€æ–°æäº¤åº”è¯¥æ˜¯ï¼š
# 2bd6844 feat(template): å®ç°æ¨¡æ¿ç³»ç»ŸåŠŸèƒ½
```

#### 2. ä¸‹ä¸€æ­¥å¼€å‘å»ºè®®

**æ¨èé¡ºåºï¼šé˜¶æ®µ6 â†’ é˜¶æ®µ7 â†’ é˜¶æ®µ9 â†’ é˜¶æ®µ10**

**é˜¶æ®µ6ï¼šå›¾ç‰‡å¤„ç†ï¼ˆæœ€å¤æ‚ï¼Œä¼˜å…ˆå®Œæˆï¼‰**
```typescript
// éœ€è¦åˆ›å»ºçš„æ–‡ä»¶ï¼š
src/hooks/useImageUpload.ts      // å›¾ç‰‡ä¸Šä¼ Hook
src/utils/imageProcessor.ts      // å›¾ç‰‡å‹ç¼©å·¥å…·
src/components/ImageUploadModal.tsx // ä¸Šä¼ ç•Œé¢

// æ ¸å¿ƒå®ç°ï¼š
1. FileReader APIè¯»å–æœ¬åœ°æ–‡ä»¶
2. Canvas APIå‹ç¼©å›¾ç‰‡ï¼ˆæœ€å¤§å®½åº¦900pxï¼‰
3. è½¬æ¢ä¸ºbase64æˆ–ä¸Šä¼ åˆ°å›¾åºŠ
4. æ’å…¥åˆ°Quillç¼–è¾‘å™¨
```

**é˜¶æ®µ7ï¼šè‰ç¨¿ç³»ç»Ÿ**
```typescript
// éœ€è¦åˆ›å»ºçš„æ–‡ä»¶ï¼š
src/hooks/useDrafts.ts           // è‰ç¨¿ç®¡ç†Hook
src/components/DraftListModal.tsx // è‰ç¨¿åˆ—è¡¨ç•Œé¢
src/utils/draftStorage.ts        // è‰ç¨¿å­˜å‚¨å·¥å…·

// localStorageç»“æ„ï¼š
{
  drafts: [
    {
      id: string,
      title: string,
      content: string,
      createdAt: number,
      updatedAt: number,
      wordCount: number
    }
  ],
  currentDraftId: string
}
```

#### 3. å¸¸ç”¨å‘½ä»¤
```bash
# å¼€å‘
npm run dev              # å¯åŠ¨å¼€å‘æœåŠ¡å™¨ï¼ˆhttp://localhost:5173ï¼‰

# æ„å»º
npm run build            # TypeScriptç¼–è¯‘ + Viteæ„å»º
npm run preview          # é¢„è§ˆç”Ÿäº§æ„å»º

# ä»£ç è§„èŒƒ
npm run lint             # ESLintæ£€æŸ¥

# Gitæ“ä½œ
git add .
git commit -m "feat(xxx): åŠŸèƒ½æè¿°"
git log --oneline -5
```

#### 4. å…³é”®æ–‡ä»¶è·¯å¾„å‚è€ƒ
```
æ ¸å¿ƒContext: src/contexts/EditorContext.tsx
ä¸»é¢˜ç³»ç»Ÿ: src/types/theme.ts
æ¨¡æ¿ç³»ç»Ÿ: src/types/template.ts
HTMLè½¬æ¢: src/utils/wechat-html.ts
å¤åˆ¶åŠŸèƒ½: src/hooks/useCopyToClipboard.ts
```

---

## é‡è¦æ³¨æ„äº‹é¡¹

### âš ï¸ å¼€å‘æ—¶å¿…é¡»éµå®ˆçš„è§„åˆ™

1. **å¾®ä¿¡æ ·å¼å…¼å®¹æ€§**
   - âŒ ä¸èƒ½ä½¿ç”¨classï¼Œå¿…é¡»ç”¨å†…è”æ ·å¼
   - âŒ ä¸èƒ½ä½¿ç”¨position: fixed/sticky
   - âŒ ä¸èƒ½ä½¿ç”¨è‡ªå®šä¹‰å­—ä½“
   - âœ… åªä½¿ç”¨ALLOWED_CSS_PROPERTIESä¸­çš„27ä¸ªå±æ€§

2. **TypeScriptä¸¥æ ¼æ¨¡å¼**
   - æ‰€æœ‰ç±»å‹å¿…é¡»æ˜ç¡®å®šä¹‰
   - ä¸èƒ½ä½¿ç”¨`any`ï¼ˆé™¤éQuillç±»å‹é—®é¢˜ï¼‰
   - å¿…é¡»å¤„ç†null/undefinedæƒ…å†µ

3. **æ€§èƒ½ä¼˜åŒ–**
   - ä½¿ç”¨React.memoé¿å…ä¸å¿…è¦çš„é‡æ¸²æŸ“
   - ä½¿ç”¨useMemo/useCallbackç¼“å­˜è®¡ç®—å’Œå‡½æ•°
   - é•¿æ–‡ç« ç¼–è¾‘æ—¶ä½¿ç”¨é˜²æŠ–

4. **Gitæäº¤è§„èŒƒ**
   - ä½¿ç”¨Conventional Commitsæ ¼å¼
   - æ¯ä¸ªé˜¶æ®µå®Œæˆåç«‹å³æäº¤
   - æäº¤ä¿¡æ¯å¿…é¡»åŒ…å«è¡¨æƒ…ç¬¦å·å’Œè¯¦ç»†è¯´æ˜

5. **æµ‹è¯•è¦æ±‚**
   - æ¯ä¸ªåŠŸèƒ½å®Œæˆåå¿…é¡»æ‰‹åŠ¨æµ‹è¯•
   - æµ‹è¯•Chromeã€Edgeã€Safariä¸‰å¤§æµè§ˆå™¨
   - å¤åˆ¶åˆ°å¾®ä¿¡å…¬ä¼—å·åå°éªŒè¯æ•ˆæœ

---

## å‚è€ƒèµ„æº

### å®˜æ–¹æ–‡æ¡£
- React: https://react.dev/
- TypeScript: https://www.typescriptlang.org/
- Vite: https://vitejs.dev/
- Tailwind CSS: https://tailwindcss.com/
- Quill.js: https://quilljs.com/

### å…³é”®APIæ–‡æ¡£
- Quill API: https://quilljs.com/docs/api/
- Quill Parchment: https://quilljs.com/guides/cloning-medium-with-parchment/
- Clipboard API: https://developer.mozilla.org/en-US/docs/Web/API/Clipboard_API
- Canvas API: https://developer.mozilla.org/en-US/docs/Web/API/Canvas_API

### ç«å“å‚è€ƒ
- ç§€ç±³: https://xiumi.us/
- 135ç¼–è¾‘å™¨: https://www.135editor.com/
- æ–°æ¦œç¼–è¾‘å™¨: https://edit.newrank.cn/

---

**æ–‡æ¡£ç‰ˆæœ¬**ï¼šv2.0
**åˆ›å»ºæ—¥æœŸ**ï¼š2025-12-30
**æœ€åæ›´æ–°**ï¼š2025-12-30 18:30
**æ›´æ–°å†…å®¹**ï¼šæ·»åŠ é˜¶æ®µ5å®ŒæˆçŠ¶æ€ã€æŠ€æœ¯æŒ‘æˆ˜è§£å†³æ–¹æ¡ˆã€å¿«é€Ÿæ¢å¤æŒ‡å—
